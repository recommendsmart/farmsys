/*!
 * Copyright (c) 2003-2026, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see https://ckeditor.com/legal/ckeditor-oss-license
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.sidebarAdapter=t())}(self,()=>(()=>{var e={"ckeditor5/src/ui.js":(e,t,i)=>{e.exports=i("dll-reference CKEditor5.dll")("./src/ui.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};return(()=>{"use strict";i.d(s,{default:()=>o});const e=class{constructor(e){this.editor=e,this.elementId=null,void 0!==this.editor.sourceElement&&(this.elementId=this.editor.sourceElement.dataset.ckeditor5PremiumElementId)}processCollaborationCommandDisable(e){if(!this.isCollaborationDisabled())return!1;const t=this.editor.commands._commands.get(e);return void 0===t||t.forceDisabled("premium-features-module"),!0}processRevisionDisable(){return!!this.isCollaborationDisabled()&&(this.editor.plugins.has("RevisionTracker")&&(this.editor.plugins.get("RevisionTracker").isEnabled=!1),!0)}isCollaborationDisabled(){return void 0!==drupalSettings.ckeditor5Premium&&void 0!==drupalSettings.ckeditor5Premium.disableCollaboration&&!0===drupalSettings.ckeditor5Premium.disableCollaboration}getEditorParentContainer(e){let t=document.getElementById(e);for(;t&&void 0!==t&&void 0!==t.classList&&!t.classList.contains("ck-editor-container");)t=t.parentElement;return t&&void 0!==t?t.parentElement:null}getSourceDataSelector(e){return{trackChanges:".track-changes",comments:".comments",revisionHistory:".revision-history",revisionHistoryContainer:".revision-history-container",resolvedSuggestionsComments:".resolved-suggestions-comments"}[e]+"-data"+`[data-ckeditor5-premium-element-id="${this.elementId}"]`}};var t=i("ckeditor5/src/ui.js");class r{static SIDEBAR_ICON='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="transform: scale(-1,1)"><path d="M5 9.5a.5.5 0 0 0 .5-.5v-.5A.5.5 0 0 0 5 8H3.5a.5.5 0 0 0-.5.5V9a.5.5 0 0 0 .5.5H5Z"/><path d="M5.5 12a.5.5 0 0 1-.5.5H3.5A.5.5 0 0 1 3 12v-.5a.5.5 0 0 1 .5-.5H5a.5.5 0 0 1 .5.5v.5Z"/><path d="M5 6.5a.5.5 0 0 0 .5-.5v-.5A.5.5 0 0 0 5 5H3.5a.5.5 0 0 0-.5.5V6a.5.5 0 0 0 .5.5H5Z"/><path clip-rule="evenodd" d="M2 19a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2Zm6-1.5h10a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5H8v15Zm-1.5-15H2a.5.5 0 0 0-.5.5v14a.5.5 0 0 0 .5.5h4.5v-15Z"/></svg>';static COLLAPSE_ICON='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 21"><path d="M9.064 14.666a.75.75 0 1 1-1.06-1.06L11.01 10.6 8.004 7.595a.75.75 0 1 1 1.06-1.06l3.55 3.549a.748.748 0 0 1-.136 1.168z"/></svg>';constructor(t){if(this.editor=t,this.storage=new e(t),this.toolbar=this.editor.ui._toolbarConfig.items,this.sidebarMode=drupalSettings.ckeditor5SidebarMode??"auto",this.resizeThreshold=0,void 0===this.editor.sourceElement)return;let i=this.getSidebarWrapper(this.editor.sourceElement.id);void 0!==i&&i&&(this.sidebarColumn=i,this.sidebar=i.parentElement,this.editorContainer=this.sidebar.parentElement,this.editor.config._config.sidebar={container:i,preventScrollOutOfView:drupalSettings.ckeditor5Premium.preventScrollOutOfView})}static get pluginName(){return"SidebarAdapter"}sidebarVisibilityModify(e=!1){this.sidebar&&void 0!==this.sidebar&&this.sidebar.classList.toggle("slider-off",e)}init(){this.sidebar&&this.editor.plugins.has("AnnotationsUIs")&&this.addToggleButton()}afterInit(){if(!this.annotationsUIs||void 0===this.annotationsUIs||!this.sidebar||void 0===this.sidebar)return;let e=!this.toolbar.includes("trackChanges")&&!this.toolbar.includes("comment")||this.storage.isCollaborationDisabled();this.sidebarVisibilityModify(e),this.handleSidebarMode(),this.editor.config._config.sidebar.preventScrollOutOfView&&this.sidebarColumn.classList.add("prevent-scroll-out-of-view"),this.editor.on("ready",()=>{this.setScrollBarObservers(),this.editor.ui.view.element&&(this.editor.ui.view.element.classList+=" ck-sidebar-enabled")})}destroy(){if(!this.annotationsUIs||void 0===this.annotationsUIs||!this.sidebar||void 0===this.sidebar)return;this.resizeObserver&&this.resizeObserver.disconnect(),this.viewElementScrollbarObserver.disconnect(),this.sidebarVisibilityModify(!0);let e=this.getSidebarToggleWrapper();e&&e.remove()}setToggleButtonState(){this.sidebar.classList.contains("narrowSidebar")?this.toggleButton.set({label:"Toggle sidebar",class:"ck-sidebar-auto-toggle",tooltip:"Switch to wide sidebar mode",tooltipPosition:"se",icon:r.SIDEBAR_ICON}):this.toggleButton.set({label:"Toggle sidebar",class:"ck-sidebar-auto-toggle",tooltip:"Switch to narrow sidebar mode",tooltipPosition:"se",icon:r.COLLAPSE_ICON})}addToggleButton(){this.toggleButton=new t.ButtonView(this.editor.locale),this.setToggleButtonState(),this.toggleButton.on("execute",()=>{this.sidebar.classList.contains("narrowSidebar")?(this.sidebar.classList.remove("narrowSidebar"),this.sidebar.classList.add("wideSidebar"),this.setToggleButtonState(),this.setCkEditorSidebarMode("wideSidebar")):(this.sidebar.classList.remove("wideSidebar"),this.sidebar.classList.add("narrowSidebar"),this.setToggleButtonState(),this.setCkEditorSidebarMode("narrowSidebar")),this.editor.editing.view.focus()}),this.toggleButton.render(),this.toggleWrapper=document.createElement("div"),this.toggleWrapper.classList.add("ck-sidebar-auto-toggle-wrapper"),this.toggleWrapper.prepend(this.toggleButton.element),this.sidebar.prepend(this.toggleWrapper),this.annotationsUIs=this.editor.plugins.get("AnnotationsUIs")}setScrollBarObservers(){this.viewElementScrollbarObserver=new ResizeObserver(e=>{const t=-37-(e[0].target.offsetWidth-e[0].target.clientWidth);this.toggleWrapper.style.marginLeft=t+"px"}),this.viewElementScrollbarObserver.observe(this.editor.ui.view.editable.element)}getSidebarWrapper(e){let t=this.storage.getEditorParentContainer(e);return t?t.querySelector(".ck-sidebar-wrapper"):null}handleSidebarMode(){let e=this.getSidebarToggleWrapper(),t=0;if(this.resizeObserver=new ResizeObserver(e=>{for(const i of e){const e=i.borderBoxSize?.[0].inlineSize;clearTimeout(this.resizeThreshold),this.resizeThreshold=setTimeout(()=>{"number"==typeof e&&e!==t&&(t=e,"auto"!==this.sidebarMode?this.setCkEditorSidebarMode(this.sidebarMode):this.updateCkeditorMode())},100)}}),this.resizeObserver.observe(this.editorContainer),"auto"!==this.sidebarMode)return this.setCkEditorSidebarMode(this.sidebarMode),void(e&&(e.style.display="none"));this.updateCkeditorMode()}getSidebarToggleWrapper(){return this.sidebar&&void 0!==this.sidebar?this.sidebar.querySelector(".ck-sidebar-auto-toggle-wrapper"):null}setCkEditorSidebarMode(e){if(this.sidebar&&void 0!==this.sidebar){if(this.sidebar.classList.contains("manual-toggled")&&"wideSidebar"===e){if(!this.annotationsUIs.isActive("inline")&&!this.annotationsUIs.isActive("wideSidebar"))return;e="narrowSidebar"}this.sidebar.classList.remove("inline","narrowSidebar","wideSidebar"),this.annotationsUIs.switchTo(e),this.sidebar.classList.add(e),this.setToggleButtonState()}}updateCkeditorMode(){let e=this.editorContainer.clientWidth,t=e>=720?"wideSidebar":e>=500?"narrowSidebar":"inline";this.setCkEditorSidebarMode(t)}}const o={SidebarAdapter:r}})(),s=s.default})());
